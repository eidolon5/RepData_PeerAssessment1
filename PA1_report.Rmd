---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading and preprocessing the data
```{r, echo=TRUE}
# Load data from source file "activity.csv" as a dataframe.
activitydf <- read.csv("activity.csv")

# Set date column to Date class type.
activitydf[,2] <- as.Date(activitydf[,2])
```


## What is mean total number of steps taken per day?
```{r activitydf, echo=TRUE}
# Sum steps per date and remove NAs.
steps <- aggregate(steps ~ date, activitydf, sum)

# Display a histogram of steps per day.
hist(steps[,2])

# Compute the mean and median steps per day.
stepsmean <- mean(steps[,2])
stepsmedian <- median(steps[,2])
```


The mean steps per day is `r stepsmean`. The median steps per day is `r stepsmedian`.


## What is the average daily activity pattern?
```{r, echo=TRUE}
# Compute the average number of steps per interval across all days.
intsteps <- aggregate(steps ~ interval, activitydf, mean)

# Plot the average number of steps per interval as computed in the last step.
plot(intsteps$interval, intsteps$steps, type="l", col="blue", ylab="Steps", xlab="Interval", main="Average Steps per Interval (across all days)")

# Find and report the interval that corresponds to the maximum number of average steps per day as calculated across all days.
maxavgsteps <- max(intsteps[,2])
index <- intsteps[intsteps$steps == max(intsteps$steps),]
```

The 5-minute interval `r index` corresponds to the maximum number of average steps per day `r maxavgsteps`, as indicated by the highest peak in the graph of average steps per interval.

## Imputing missing values
```{r, echo=TRUE}
# Compute the total number of NAs within the dataset.
numNA <- sum(is.na(activitydf[,1]))

# Create a new dataset and set NAs to 0 per the strategy described in the text.
activitydf2 <- activitydf
NAs <- is.na(activitydf2)
activitydf2[NAs] <- 0
steps2 <- aggregate(steps ~ date, activitydf2, sum)

```

The total number of NAs within the steps column of the activity dataset is `r numNA`. Each NA will be replaced by setting its value to 0 to reduce bias resulting from missing values. 

```{r, echo=TRUE}
# Plot the histogram of total steps per day using the dataset with NAs filled in.
hist(steps2[,2])

# Calculate and report the mean and median steps per day.
stepsmean2 <- mean(steps2[,2])
stepsmedian2 <- median(steps2[,2])
```

The mean steps per day as computed based on the dataset with NAs set to 0 is `r stepsmean2` and the median steps per day is `r stepsmedian2`. The mean and median values calculated on the revised dataset are *less than* from the original mean and median values, respectively, calculated above because the missing data was replaced with 0. Additionally, the histogram appropriately redistributes to include more steps in the bin of [0,5000].

## Are there differences in activity patterns between weekdays and weekends?
```{r , echo=TRUE}
# Create a list that assigns the name of the day to each date within the filled in dataset. Bind activitydays with activitydf2 to form new data frame.
activitydf3 <- cbind(activitydf2, weekdays(activitydf2[,2]))
names(activitydf3) <- c("steps", "date", "interval", "day")

# Splice actividydf3 into two datasets: one with weekdays and one with weekends.
weekdayz <- c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")
weekendz <- c("Saturday", "Sunday")
wkdaysactivity <- activitydf3[activitydf3$day == weekdayz,]
wkendsactivity <- activitydf3[activitydf3$day == weekendz,]

# Produce two timeseries for the average number of steps taken across weekdays and another averaged across weekends. 
wkdaysteps <- aggregate(steps ~ interval, wkdaysactivity, mean)
wkendsteps <- aggregate(steps ~ interval, wkendsactivity, mean)

# Plot the two time series in two windows of the same plot.
#par(mfrow=c(2,1))
layout(matrix(c(1,2),2, byrow=TRUE))
plot(wkdaysteps$interval, wkdaysteps$steps, type="l", col="blue", ylab="Steps", xlab="Interval", main="Average Steps per Interval (across weekdays only)")
plot(wkendsteps$interval, wkendsteps$steps, type="l", col="blue", ylab="Steps", xlab="Interval", main="Average Steps per Interval (across weekends only)")

```

